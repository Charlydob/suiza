<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Viajecito con Laura</title>
  <link rel="stylesheet" href="Styles/styles.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="Styles/menuInferior.css" />
  <link rel="stylesheet" href="Styles/itinerario.css" />
  <link rel="stylesheet" href="Styles/favoritos.css" />
  <link rel="stylesheet" href="Styles/gastos.css" />

  <link rel="apple-touch-icon" href="Recursos/icono.png" />
</head>


<body>


  <main id="contenedor-paginas">
    <!-- ğŸŒ PÃGINAS -->
<!--ğŸŸ¨ğŸŸ¨ğŸŸ¨ğŸŸ¨ MAPA ğŸŸ¨ğŸŸ¨ğŸŸ¨ğŸŸ¨-->
    <section id="pagina-mapa" class="pagina" >
      <div id="sidebar">
        <div id="sidebarContenido">
        <h2>Viajecito con Laura</h2>

            <div id="location-controls">
              <button onclick="getLocation()" class="action-button">Ver mi ubicaciÃ³n</button>
              <div class="search-group">
                <input type="text" id="locationSearch" placeholder="Buscar ubicaciÃ³n..." />
                <button onclick="buscarLugar()">ğŸ”ğŸŒ</button>
              </div>
              <div class="search-group">
                <input type="text" id="inputBusquedaLibre" placeholder="Buscar elemento en concreto..." style="width: 100%; padding: 8px;" />
                <button onclick="buscar('__libre__')">ğŸ”ğŸ“</button>
              </div>

              <label>v.1.5</label>
              <label for="radiusSlider" class="slider-label">Radio bÃºsqueda: <span id="radiusValue">1000</span>m</label>
              <input type="range" id="radiusSlider" min="0" max="10000" value="1000" step="100">
            </div>

            <div class="filter-grid">
                  <div class="filter-card" id="btn-sitios_bonitos" onclick="toggleTipo('sitios_bonitos')">
                    <img src="Recursos/img/camping.png" alt="sitios_bonitos">
                    <span>Campings</span>
                  </div>
                  <div class="filter-card" id="btn-gasolinera" onclick="toggleTipo('gasolinera')">
                    <img src="Recursos/img/gasolinera.png" alt="gasolinera">
                    <span>Gasolineras</span>
                  </div>
                  <div class="filter-card" id="btn-parking" onclick="toggleTipo('parking')">
                    <img src="Recursos/img/parking.png" alt="parking">
                    <span>Parkings</span>
                  </div>
                  <div class="filter-card inactivo" id="btn-hotel" onclick="toggleTipo('hotel')">
                    <img src="Recursos/img/hotel.png" alt="hotel">
                    <span>Hoteles</span>
                  </div>
                  <div class="filter-card inactivo" id="btn-airbnb" onclick="toggleTipo('airbnb')">
                    <img src="Recursos/img/airbnb.png" alt="airbnb">
                    <span>Airbnb</span>
                  </div>
                  <div class="filter-card inactivo" id="btn-luggage" onclick="toggleTipo('luggage')">
                    <img src="Recursos/img/maleta.png" alt="maleta">
                    <span>Consigna</span>
                  </div>
                  <div class="filter-card inactivo" id="btn-airport" onclick="toggleTipo('airport')">
                    <img src="Recursos/img/aeropuerto.png" alt="aeropuerto">
                    <span>Aeropuertos</span>
                  </div>
                    <div class="filter-card inactivo" id="btn-tourism" onclick="toggleTipo('tourism')">
                      <img src="Recursos/img/turismo.png" alt="punto turÃ­stico">
                  <span>Turismo</span>
                  </div>
                  <div class="filter-card inactivo" id="btn-restaurant" onclick="toggleTipo('restaurant')">
                    <img src="Recursos/img/restaurante.png" alt="restaurante">
                    <span>Restaurantes</span>
                  </div>
                  
                  <div class="filter-card inactivo" id="btn-cafe" onclick="toggleTipo('cafe')">
                    <img src="Recursos/img/cafeteria.png" alt="cafeterÃ­a">
                    <span>CafeterÃ­as</span>
                  </div>
                  
                  <div class="filter-card inactivo" id="btn-hospital" onclick="toggleTipo('hospital')">
                <img src="Recursos/img/hospital.png" alt="hospital">
                <span>Hospitales</span>
                  </div>

                  <div class="filter-card inactivo" id="btn-favoritos" onclick="toggleTipo('favoritos')">
                <img src="Recursos/img/favorito.png" alt="favoritos">
                <span>Favoritos</span>
                  </div>

                  
            </div>
                  <button onclick="clearAll()" class="clear-button">ğŸ§¹ Limpiar</button>
                  <div id="status">Esperando ubicaciÃ³n...</div>
        <!-- â­ Lista de Favoritos en el Sidebar -->
                <div id="listaFavoritosSidebar">
                  <h3>â­ Favoritos</h3>
                  <div id="filtrosFavoritos">
                    <input type="text" id="buscadorFavoritos" placeholder="ğŸ” Buscar..."">
                      <template id="template-favorito-sidebar">
                        <div class="favorito-sidebar-tarjeta favorito-sidebar-item">
                          <!-- Contenedor de la info -->
                          <div class="favorito-sidebar-info">
                            <!-- Texto superpuesto -->
                            <div class="favorito-sidebar-detalles">
                              <h3 class="favorito-sidebar-nombre">Nombre del lugar</h3>
                              <p class="favorito-sidebar-ubicacion">Ciudad, PaÃ­s</p>
                              <p class="favorito-sidebar-notas">ğŸ“ Notas personales</p>
                            </div>
                            <!-- Botones -->
                            <div class="favorito-sidebar-botones">
                              <button class="btn-ver">ğŸ“ Ver en el mapa</button>
                              <button class="btn-eliminar">ğŸ—‘ï¸ Eliminar</button>
                            </div>
                          </div>
                        </div>
                      </template>
                    <select id="filtroTipoFavoritos">
                      <option value="">Todos los tipos</option>
                      <option value="sitios_bonitos">sitios_bonitos</option>
                      <option value="gasolinera">Gasolinera</option>
                      <option value="parking">Parking</option>
                      <option value="hotel">Hotel</option>
                      <option value="airbnb">Airbnb</option>
                      <option value="luggage">Consigna</option>
                      <option value="airport">Aeropuerto</option>
                      <option value="tourism">Turismo</option>
                      <option value="restaurant">Restaurante</option>
                      <option value="cafe">CafeterÃ­a</option>
                      <option value="hospital">Hospital</option>
                    </select>

                    <select id="ordenFavoritos" style="width: 100%;">
                      <option value="distanciaAsc">ğŸ”½ Distancia (cerca primero)</option>
                      <option value="distanciaDesc">ğŸ”¼ Distancia (lejos primero)</option>
                    </select>
                  </div>

                  <div id="contenedorFavoritosSidebar"></div>
                </div>

      </div>
      <!-- ğŸ“ Editor de Favorito -->
      <!-- MODAL DEL EDITOR DE FAVORITOS -->
<!-- MODAL EDITOR DE FAVORITO DESDE SIDEBAR -->
<div id="modal-fondo-favoritos" style="display: none;">
  <div id="modal-contenido-favoritos" class="editor-favorito">
    <h3>Editar lugar</h3>
    <label>Nombre personalizado:</label>
    <input type="text" id="editNombre">
    <label>Precio:</label>
    <input type="text" id="editPrecio">
    <select id="editMoneda">
      <option value="EUR">EUR</option>
      <option value="CHF">CHF</option>
      <option value="USD">USD</option>
    </select>
    <label>Horario:</label>
    <input type="text" id="editHorario">
    <label>Observaciones:</label>
    <textarea id="editNotas" rows="3"></textarea>
    <button onclick="guardarEdicionFavoritoDesde('sidebar')">ğŸ’¾ Guardar</button>
    <button onclick="borrarFavoritoDesde('sidebar')">ğŸ—‘ï¸ Eliminar</button>
    <button onclick="cerrarEditorFavoritoDesde('sidebar')">âŒ Cancelar</button>
  </div>
</div>


    </div>

      <button id="closeSidebar">â€¹</button>
      <button id="toggleMenu">â€º</button>

        <div id="map"></div>
    </section>
<!--ğŸŸ¨ğŸŸ¨ğŸŸ¨ğŸŸ¨ ITINERARIO ğŸŸ¨ğŸŸ¨ğŸŸ¨ğŸŸ¨-->
<section id="pagina-itinerario" class="pagina" style="display: none;">
  <h2 class="titulo-itinerario">ğŸ—“ï¸ ITINERARIO</h2>
  <p class="subtitulo-itinerario">Crea tu itinerario.</p>

  <!-- Contenedor principal de secciones de ubicaciones -->
  <div id="contenedor-ubicaciones-itinerario"></div>

  <!-- BotÃ³n flotante para aÃ±adir nueva ubicaciÃ³n -->
  <button id="btn-nueva-ubicacion" class="boton-flotante">ï¼‹</button>
</section>

<!-- TEMPLATE: SecciÃ³n de UbicaciÃ³n -->
<template id="template-ubicacion">
  <div class="seccion-ubicacion">
    <button class="btn-cerrar-ubicacion" title="Eliminar ubicaciÃ³n">âœ–</button>

    <div class="header-ubicacion">
      <h2 class="titulo-ubicacion"></h2>
    </div>
    <div class="contenedor-dias"></div>
    <button class="btn-agregar-dia">AÃ±adir DÃ­a</button>
  </div>
</template>

<!-- TEMPLATE: DÃ­a dentro de una ubicaciÃ³n -->
<template id="template-dia">
  <div class="dia-itinerario">
    <h3 class="titulo-dia"></h3>
        <button class="btn-cerrar-dia" title="Eliminar dÃ­a">âœ–</button>

    <div class="carousel-dia"></div>
    <button class="btn-agregar-evento">AÃ±adir evento</button>
  </div>
</template>

<!-- TEMPLATE: Tarjeta de evento o favorito -->
<template id="template-tarjeta-itinerario">
  <div class="tarjeta-itinerario">

    <span class="etiqueta-evento"></span>
    <button class="checkbox-itinerario"></button>
    <div class="info-tarjeta">
      <strong class="titulo-evento"></strong>
    </div>
  </div>
</template>

<!-- MODALES DINÃMICOS -->
<div id="modal-fondo" style="display:none">
  <div id="modal-contenido"></div>
</div>
<!--ğŸŸ¨ğŸŸ¨ğŸŸ¨ğŸŸ¨ FAVORITOS ğŸŸ¨ğŸŸ¨ğŸŸ¨ğŸŸ¨-->
    <section id="pagina-favoritos" class="pagina" style="display: none;">
      <h2>â­ Favoritos</h2>
      <p>Guarda los lugares que mÃ¡s te gusten y accede fÃ¡cilmente a ellos.</p>

      <div id="listaFavoritos">
        <div id="contenedorFavoritos" class="lista-favoritos">
          <!-- AquÃ­ se renderizan las tarjetas -->
        </div>
      </div>

      <!-- Plantilla de tarjeta individual -->
      <template id="template-favorito">
        <div class="favorito-tarjeta">
          <!-- Imagen del lugar -->
          <div class="favorito-imagen">
            <img src="" 
              alt="Imagen del lugar" 
              onerror="this.onerror=null; this.src='Recursos/img/default.jpg';">

          </div>

          <!-- Contenedor de la info -->
          <div class="favorito-info">
            <!-- Texto superpuesto -->
            <div class="favorito-detalles">
              <div class="nombre-favorito">
                <h3 class="favorito-nombre">Nombre del lugar</h3>
                <input type="checkbox" class="favorito-visitado" title="Marcar como visitado">
              </div>
              <div class="detalles-ubicacion">
                <p class="favorito-ubicacion">Ciudad, PaÃ­s</p>
                <p class="favorito-direccion">DirecciÃ³n exacta</p>
              </div>
              <div class="detalles-aÃ±adidos">
                <p class="favorito-notas">ğŸ“ Notas personales</p>
                <p class="favorito-precio">ğŸ’° Precio estimado</p>
                <p class="favorito-horario">ğŸ•’ Horario</p>
              </div>
              </div>
            </div>

            <!-- Botones -->
            <div class="favorito-botones">
              <button class="btn-editar">âœï¸Editar</button>
              <button class="btn-ver">ğŸ“ Mapa</button>
              <button class="btn-eliminar">ğŸ—‘ï¸ Eliminar</button>
            </div>
                  </div>
      <!-- ğŸ“ Editor de Favorito -->
     <div id="modal-fondo-editor" style="display: none;">
  <div id="editorFavoritoLista" class="modal-formulario-favorito-lista">
    <h3>Editar lugar</h3>
    <input type="text" id="editNombreLista" placeholder="">
<div class="selectores">
<input type="text" id="editPrecioLista">
    <select id="editMonedaLista">
      <option value="EUR">EUR</option>
      <option value="CHF">CHF</option>
      <option value="USD">USD</option>
    </select>

    <input type="text" id="editHorarioLista" placeholder="00:00">
</div>
    <label for="editNotasLista">Observaciones:</label>
    <textarea id="editNotasLista" rows="3"></textarea>

    <div class="fila-botones-editor">
      <button onclick="guardarEdicionFavoritoDesde('lista')">ğŸ’¾</button>
      <button onclick="borrarFavoritoDesde('lista')">ğŸ—‘ï¸</button>
      <button onclick="cerrarEditorFavoritoDesde('lista')">âŒ</button>
    </div>
  </div>
</div>

          </div>
        </div>
      </template>
    </section>
<!--ğŸŸ¨ğŸŸ¨ğŸŸ¨ğŸŸ¨ GASTOS ğŸŸ¨ğŸŸ¨ğŸŸ¨ğŸŸ¨-->
<section id="pagina-gastos" class="pagina-gastos" style="display: none;">
  <h2>ğŸ’° Resumen de gastos</h2>
  <p>Calculamos automÃ¡ticamente lo que costarÃ¡ cada dÃ­a y lo que se va sumando durante el viaje.</p>

  <div id="contenedor-gastos-dias">
    <!-- AquÃ­ se insertan los dÃ­as y sus gastos -->
  </div>
<div id="selector-moneda">
  <label for="monedaDestino">Mostrar totales en:</label>
  <select id="monedaDestino" onchange="cambiarMonedaDestino()">
    <option value="CHF">CHF</option>
    <option value="EUR">EUR</option>
    <option value="USD">USD</option>
  </select>
</div>

  <div id="gastos-total-final">
    <h3>Total estimado del viaje: <span id="gastos-total">0 CHF</span></h3>
  </div>
</section>

<!--ğŸŸ¨ğŸŸ¨ğŸŸ¨ğŸŸ¨ NOTAS ğŸŸ¨ğŸŸ¨ğŸŸ¨ğŸŸ¨-->
    <section id="pagina-notas" class="pagina-app" style="display: none;">
      <h2>ğŸ“ Notas</h2>
      <p>Guarda ideas, fotos de reservas, nÃºmeros importantesâ€¦</p>
    </section>
<!-- ğŸŒŸ MENÃš INFERIOR -->
<div id="menuInferior">
  <button class="nav-btn" data-page="itinerario">
    <img src="Recursos/img/itinerario.png" alt="Itinerario">
    <span>Itinerario</span>
  </button>
  <button class="nav-btn" data-page="favoritos">
    <img src="Recursos/img/favoritos.png" alt="Favoritos">
    <span>Favs</span>
  </button>
  <button class="nav-btn activo" data-page="mapa">
    <img src="Recursos/img/mapa.png" alt="Mapa">
    <span>Mapa</span>
  </button>
  <button class="nav-btn" data-page="gastos">
    <img src="Recursos/img/gastos.png" alt="gastos">
    <span>Gastos</span>
  </button>
  <button class="nav-btn" data-page="notas">
    <img src="Recursos/img/notas.png" alt="Notas">
    <span>Notas</span>
  </button>
</div>
</main>
</body>
  <!-- Script logger USAR SOLO PARA DESARROLLO PARA BUSCAR ERRORES
<script src="Scripts/logger.js"></script>
-->
<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>

<!-- ConfiguraciÃ³n Firebase -->
<script>
  const firebaseConfig = {
    apiKey: "AIzaSyAIRkX0m-qORww2kcYl_mbXm6IKh7j02dc",
    authDomain: "suizaapp.firebaseapp.com",
    databaseURL: "https://suizaapp-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "suizaapp",
    storageBucket: "suizaapp.firebasestorage.app",
    messagingSenderId: "780629642721",
    appId: "1:780629642721:web:f8d2c33e1766b293ab96a0"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();
    db.ref().once("value")
    .then(snapshot => {
      console.log("ğŸ”¥ Firebase raÃ­z:", snapshot.val());
    });
  const rutaFavoritos = "favoritos/charlyylaura";
  const rutaIgnorados = "ignorados/charlyylaura";
  const rutaItinerario = "itinerario/charlyylaura"; 
  const rutaGastos = "gastos/charlyylaura";
  const rutaNotas = "notas/charlyylaura";
</script>
<!-- Script variables -->
<script src="Scripts/variables.js"></script>
<!-- Script mapa -->
<script src="Scripts/mapa.js"></script>
<!-- Gestion favoritos -->
<script src="Scripts/favoritos.js"></script>
<!-- Script botones -->
<script src="Scripts/botones.js"></script>
<!-- Script Sidebar -->
<script src="Scripts/sidebar.js"></script>
<script async defer
  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA8KhfGc61uBT3DHS1hiCEl7HgnFYaWySI&libraries=places&callback=getLocation">
</script>
<!-- Script testeo de variables -->
<script src="Scripts/testVariables.js"></script>
<!-- LÃ³gica del menÃº inferior de navegaciÃ³n -->
<script src="Scripts/menuInferior.js"></script>
<!-- LÃ³gica de la ventana itinerario -->
<script src="Scripts/itinerario.js"></script>
<!-- LÃ³gica de la ventana gastos -->
<script src="Scripts/gastos.js"></script>
</body>
</html>
